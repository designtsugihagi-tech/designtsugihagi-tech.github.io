<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>五つの猫の物語</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500&family=Noto+Serif+JP:wght@400;600;900&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --intro-duration: 25s;
            --text-color: #4a4a4a;
            --bg-color: #fcfaf8;
            --main-serif-font: 'Noto Serif JP', serif;
        }

        body {
            margin: 0;
            padding: 0;
            overflow: hidden; /* スクロールバーが出ないように固定 */
            background-color: var(--bg-color);
            font-family: var(--main-serif-font);
        }

        /* ========================================
           1. オープニングアニメーション（背面レイヤー）
           ========================================
        */
        #splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #ffffff;
            z-index: 1; /* 背面に配置 */
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 2rem;
            box-sizing: border-box;
        }

        /* アニメーション関連のCSS */
        .intro-card {
            background-color: transparent;
            width: 100%;
            max-width: 1000px;
            aspect-ratio: 16/9;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            position: relative;
        }
        .outline-svg { width: 90%; height: auto; overflow: visible; }
        .outline-text { font-family: var(--main-serif-font); font-size: 90px; font-weight: 900; text-anchor: middle; }
        
        .outline-text tspan {
            fill: var(--text-color); fill-opacity: 0; stroke: var(--text-color);
            stroke-width: 1px; stroke-dasharray: 600; stroke-dashoffset: 600;
            animation-duration: var(--intro-duration); animation-timing-function: linear;
            animation-iteration-count: 1; animation-fill-mode: forwards;
        }
        .border-line {
            fill: none; stroke: var(--text-color); stroke-width: 1px;
            stroke-dasharray: 1200; stroke-dashoffset: 1200;
            animation: borderDraw var(--intro-duration) linear 1 forwards;
        }
        
        /* 既存の左右の波紋 */
        .ripple-circle {
            fill: none; stroke: var(--text-color); stroke-width: 2px;
            opacity: 0; transform-origin: center;
            animation: rippleEffect var(--intro-duration) ease-out 1 forwards;
        }

        /* ■ 新規追加：中央の大きな波紋 */
        .center-ripple-circle {
            fill: none; stroke: var(--text-color); stroke-width: 2.5px;
            opacity: 0; transform-origin: center;
            animation: centerRippleEffect var(--intro-duration) ease-out 1 forwards;
        }

        /* アニメーション割り当て */
        .outline-text tspan:nth-child(1) { animation-name: char01; }
        .outline-text tspan:nth-child(2) { animation-name: char02; }
        .outline-text tspan:nth-child(3) { animation-name: char03; }
        .outline-text tspan:nth-child(4) { animation-name: char04; }
        .outline-text tspan:nth-child(5) { animation-name: char05; }
        .outline-text tspan:nth-child(6) { animation-name: char06; }
        .outline-text tspan:nth-child(7) { animation-name: char07; }
        .outline-text tspan:nth-child(8) { animation-name: char08; }
        .outline-text tspan:nth-child(9) { animation-name: char09; }
        .outline-text tspan:nth-child(10) { animation-name: char10; }
        .outline-text tspan:nth-child(11) { animation-name: char11; }
        .outline-text tspan:nth-child(12) { animation-name: char12; }
        .outline-text tspan:nth-child(13) { animation-name: char13; }
        .outline-text tspan:nth-child(14) { animation-name: char14; }

        @keyframes char01 { 0% { stroke-dashoffset: 600; fill-opacity: 0; } 8% { stroke-dashoffset: 0; fill-opacity: 0; } 14% { stroke-dashoffset: 0; fill-opacity: 0; } 18% { stroke-dashoffset: 0; fill-opacity: 1; } 100% { stroke-dashoffset: 0; fill-opacity: 1; } }
        @keyframes char02 { 0% { stroke-dashoffset: 600; fill-opacity: 0; } 8% { stroke-dashoffset: 0; fill-opacity: 0; } 14% { stroke-dashoffset: 0; fill-opacity: 0; } 18% { stroke-dashoffset: 0; fill-opacity: 1; } 100% { stroke-dashoffset: 0; fill-opacity: 1; } }
        @keyframes char03 { 0%, 2% { stroke-dashoffset: 600; fill-opacity: 0; } 10% { stroke-dashoffset: 0; fill-opacity: 0; } 14% { stroke-dashoffset: 0; fill-opacity: 0; } 18% { stroke-dashoffset: 0; fill-opacity: 1; } 100% { stroke-dashoffset: 0; fill-opacity: 1; } }
        @keyframes char04 { 0%, 4% { stroke-dashoffset: 600; fill-opacity: 0; } 12% { stroke-dashoffset: 0; fill-opacity: 0; } 14% { stroke-dashoffset: 0; fill-opacity: 0; } 18% { stroke-dashoffset: 0; fill-opacity: 1; } 100% { stroke-dashoffset: 0; fill-opacity: 1; } }
        @keyframes char05 { 0%, 4% { stroke-dashoffset: 600; fill-opacity: 0; } 12% { stroke-dashoffset: 0; fill-opacity: 0; } 14% { stroke-dashoffset: 0; fill-opacity: 0; } 18% { stroke-dashoffset: 0; fill-opacity: 1; } 100% { stroke-dashoffset: 0; fill-opacity: 1; } }
        @keyframes char06 { 0%, 6% { stroke-dashoffset: 600; fill-opacity: 0; } 14% { stroke-dashoffset: 0; fill-opacity: 0; } 18% { stroke-dashoffset: 0; fill-opacity: 1; } 100% { stroke-dashoffset: 0; fill-opacity: 1; } }
        @keyframes char07 { 0%, 8% { stroke-dashoffset: 600; fill-opacity: 0; } 16% { stroke-dashoffset: 0; fill-opacity: 0; } 20% { stroke-dashoffset: 0; fill-opacity: 0; } 24% { stroke-dashoffset: 0; fill-opacity: 1; } 100% { stroke-dashoffset: 0; fill-opacity: 1; } }
        @keyframes char08 { 0%, 8% { stroke-dashoffset: 600; fill-opacity: 0; } 16% { stroke-dashoffset: 0; fill-opacity: 0; } 20% { stroke-dashoffset: 0; fill-opacity: 0; } 24% { stroke-dashoffset: 0; fill-opacity: 1; } 100% { stroke-dashoffset: 0; fill-opacity: 1; } }
        @keyframes char09 { 0%, 10% { stroke-dashoffset: 600; fill-opacity: 0; } 18% { stroke-dashoffset: 0; fill-opacity: 0; } 20% { stroke-dashoffset: 0; fill-opacity: 0; } 24% { stroke-dashoffset: 0; fill-opacity: 1; } 100% { stroke-dashoffset: 0; fill-opacity: 1; } }
        @keyframes char10 { 0%, 12% { stroke-dashoffset: 600; fill-opacity: 0; } 20% { stroke-dashoffset: 0; fill-opacity: 0; } 24% { stroke-dashoffset: 0; fill-opacity: 1; } 100% { stroke-dashoffset: 0; fill-opacity: 1; } }
        @keyframes char11 { 0%, 12% { stroke-dashoffset: 600; fill-opacity: 0; } 20% { stroke-dashoffset: 0; fill-opacity: 0; } 24% { stroke-dashoffset: 0; fill-opacity: 1; } 100% { stroke-dashoffset: 0; fill-opacity: 1; } }
        @keyframes char12 { 0%, 14% { stroke-dashoffset: 600; fill-opacity: 0; } 20% { fill-opacity: 0; } 22% { stroke-dashoffset: 0; } 24% { stroke-dashoffset: 0; fill-opacity: 1; } 100% { stroke-dashoffset: 0; fill-opacity: 1; } }
        @keyframes char13 { 0%, 16% { stroke-dashoffset: 600; fill-opacity: 0; } 20% { fill-opacity: 0; } 24% { stroke-dashoffset: 0; fill-opacity: 1; } 100% { stroke-dashoffset: 0; fill-opacity: 1; } }
        @keyframes char14 { 0%, 16% { stroke-dashoffset: 600; fill-opacity: 0; } 20% { fill-opacity: 0; } 24% { stroke-dashoffset: 0; fill-opacity: 1; } 100% { stroke-dashoffset: 0; fill-opacity: 1; } }
        
        /* 囲み線：開始23%〜終了33% */
        @keyframes borderDraw { 
            0%, 23% { stroke-dashoffset: 1200; opacity: 1; } 
            33% { stroke-dashoffset: 0; opacity: 1; } 
            100% { stroke-dashoffset: 0; opacity: 1; } 
        }
        
        /* 左右の波紋（33%で開始, 37%で終了） */
        @keyframes rippleEffect { 0%, 33% { r: 0; opacity: 1; stroke-width: 2px; } 37% { r: 150px; opacity: 0; stroke-width: 0.5px; } 100% { r: 150px; opacity: 0; stroke-width: 0; } }

        /* 中央の波紋（左右(33%)より2%遅い35%で開始、46%で終了） */
        @keyframes centerRippleEffect { 
            0%, 35% { r: 0; opacity: 1; stroke-width: 2.5px; } 
            46% { r: 500px; opacity: 0; stroke-width: 0; } 
            100% { r: 500px; opacity: 0; stroke-width: 0; } 
        }

        /* ========================================
           2. 遷移先を表示するフレーム（前面レイヤー）
           ========================================
        */
        #content-frame {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
            
            z-index: 10; /* アニメーションより手前に表示 */
            
            opacity: 0; /* 最初は透明にしておく */
            pointer-events: none; /* 透明なときはクリック等を通さない */
            
            /* ふんわり表示させるためのトランジション（3秒かけてフェードイン） */
            transition: opacity 3s ease-in-out;
            background-color: #fff; /* 背景を白にして下の層を隠す */
        }

        /* 表示状態のクラス */
        #content-frame.visible {
            opacity: 1;
            pointer-events: auto;
        }

        /* 2回目以降のアクセス用：即座に表示 */
        #content-frame.immediate {
            opacity: 1;
            pointer-events: auto;
            transition: none; /* アニメーションなし */
        }

        /* 2回目以降：背景のアニメーションは隠す（リソース節約） */
        #splash-screen.hidden-immediate {
            display: none;
        }

    </style>
</head>
<body>

    <div id="splash-screen">
        <div class="intro-card">
            <svg class="outline-svg" viewBox="0 0 1000 300">
                <g class="outline-group">
                    <path class="border-line" d="M 40 30 L 945 30 L 945 280" />
                    <path class="border-line" d="M 945 280 L 40 280 L 40 30" />
                    
                    <!-- 既存の左右の波紋 -->
                    <circle class="ripple-circle" cx="40" cy="30" r="0" />
                    <circle class="ripple-circle" cx="945" cy="280" r="0" />
                    
                    <!-- ■ 新規追加：中央の大きな波紋（500, 150 はviewBoxの中心） -->
                    <circle class="center-ripple-circle" cx="500" cy="150" r="0" />
                    
                    <text x="492.5" y="130" class="outline-text">
                        <tspan>風</tspan><tspan>花</tspan><tspan style="font-size: 81px;">と</tspan><tspan>水</tspan><tspan>月</tspan><tspan style="font-size: 81px;">と</tspan>
                        <tspan x="492.5" dy="120">蒼</tspan><tspan>泉</tspan><tspan style="font-size: 81px;">と</tspan><tspan>灯</tspan><tspan>莉</tspan><tspan style="font-size: 81px;">と</tspan><tspan>咲</tspan><tspan>花</tspan>
                    </text>
                </g>
            </svg>
        </div>
    </div>

    <iframe id="content-frame" title="Main Content"></iframe>

    <script>
        window.addEventListener('DOMContentLoaded', () => {
            const iframe = document.getElementById('content-frame');
            const splash = document.getElementById('splash-screen');
            const targetUrl = 'https://designtsugihagi-tech.github.io/memory_corridor/corridor.html';

            // セッションストレージを確認
            if (sessionStorage.getItem('visited')) {
                // ■ 2回目以降（即時表示）
                
                // アニメーションを非表示
                splash.classList.add('hidden-immediate');
                
                // フレームにURLをセット
                iframe.src = targetUrl;
                
                // 即座に表示するクラスを付与
                iframe.classList.add('immediate');

            } else {
                // ■ 初回アクセス時（アニメーション → フェードイン）
                
                // 1. 少し早めに裏でページ読み込みを開始する（8秒後くらい）
                //    これにより、フェードイン時にはページが表示可能な状態にしておく
                setTimeout(() => {
                    iframe.src = targetUrl;
                }, 8000);

                // 2. アニメーション完了に合わせてフェードイン（11秒後）
                setTimeout(() => {
                    iframe.classList.add('visible');
                    
                    // 訪問済みフラグを保存
                    sessionStorage.setItem('visited', 'true');
                    
                    // (任意) フェードイン完了後に裏のアニメーションを完全に消すなら
                    // setTimeout(() => { splash.style.display = 'none'; }, 3000);
                }, 11000);
            }
        });
    </script>
</body>
</html>
